(function(a){
		 $("a[rel=removefollow]").live("click",
        function() {
        $.guang.dialog.isLogin();
		 $this = $(this);
		 $.ajax({
            url: GUANGER.path + "index.php?app=user&ac=do&ts=user_nofollow",
            type: "post",
            dataType: "json",
            data: {
                tuserId: $this.attr("data-userid")
            },
            success: function(b) {
                switch (b.code) {
                case 100:
                   // this.jQueryDom.data("enable", "true");
                    $.guang.removeFollowCallback(b, $this);
                    break;
                case 101:
                   // $this.data("enable", "true");
                    $.guang.tip.conf.tipClass = "tipmodal tipmodal-error2";
                    $.guang.tip.show($this, "\u53c2\u6570\u9519\u8bef");
                    break;
                case 103:
                   // $this.data("enable", "true");
                    $.guang.tip.conf.tipClass = "tipmodal tipmodal-error2";
                    $.guang.tip.show($this, "\u91cd\u590d\u5173\u6ce8\u4e86\u4f60\u7684\u670b\u53cb\uff01");
                    break;
                case 111:
                    $this.data("enable", "true");
                    $.guang.tip.conf.tipClass = "tipmodal tipmodal-error2";
                    $.guang.tip.show($this, "\u62b1\u6b49\uff0c\u4f60\u7684\u5173\u6ce8\u5df2\u8fbe\u4e0a\u9650\u3002");
                    break;
                case 300:
                    $.guang.dialog.login()
                }
				}
            })
    });
	
	
	
	$("a[rel=follow]").live("click",
    function() {
        $.guang.dialog.isLogin();
		 $this = $(this);
		 $.ajax({
            url: GUANGER.path + "index.php?app=user&ac=do&ts=user_follow",
            type: "post",
            dataType: "json",
            data: {
                tuserId: $this.attr("data-userid")
            },
            success: function(b) {
                switch (b.code) {
                case 100:
                   // this.jQueryDom.data("enable", "true");
                    $.guang.addFollowCallback(b, $this);
                    break;
                case 101:
                   // $this.data("enable", "true");
                    $.guang.tip.conf.tipClass = "tipmodal tipmodal-error2";
                    $.guang.tip.show($this, "\u53c2\u6570\u9519\u8bef");
                    break;
                case 103:
                   // $this.data("enable", "true");
                    $.guang.tip.conf.tipClass = "tipmodal tipmodal-error2";
                    $.guang.tip.show($this, "\u91cd\u590d\u5173\u6ce8\u4e86\u4f60\u7684\u670b\u53cb\uff01");
                    break;
                case 111:
                    $this.data("enable", "true");
                    $.guang.tip.conf.tipClass = "tipmodal tipmodal-error2";
                    $.guang.tip.show($this, "\u62b1\u6b49\uff0c\u4f60\u7684\u5173\u6ce8\u5df2\u8fbe\u4e0a\u9650\u3002");
                    break;
                case 300:
                    $.guang.dialog.login()
                }
				}
            })
    });
	
	
	$("a[rel=removefans]").live("click",
    function() {
        $.guang.dialog.isLogin();
		 $this = $(this);
		 unm = $this.attr("data-usernick");
		 if(confirm('您确定要移除粉丝"'+ unm +'"吗？')){
		 $.ajax({
            url: GUANGER.path + "index.php?app=user&ac=do&ts=removefans",
            type: "post",
            dataType: "json",
            data: {
                tuserId: $this.attr("data-userid")
            },
            success: function(b) {
                switch (b.code) {
                case 100:
                   // this.jQueryDom.data("enable", "true");
                    $this.parent("div").parent("div").hide();
                    break;
               
                case 300:
                    $.guang.tip.conf.tipClass = "tipmodal tipmodal-error2";
                    $.guang.tip.show($this, '移除粉丝"'+ unm +'"失败');
                    break;
                }
				}
            })
		 }
    });
	
	
	
	
	
	 $.guang.addFollowCallback = function(b, a) {
        "0" == a.attr("data-followtype") && (b.isYouFollowed ? a.after("<div class='followed-btn-big'>\u4e92\u76f8\u5173\u6ce8<span class='mr5 ml5'>|</span><a rel='removefollow' data-followtype='0' data-usernick=" + a.data("usernick") + " data-userid='" + a.data("userid") + "' href='javascript:;'>\u53d6\u6d88</a></div>") : a.after("<div class='followed-btn-big'>\u5df2\u5173\u6ce8<span class='mr5 ml5'>|</span><a rel='removefollow' data-followtype='0' data-usernick=" + a.data("usernick") + " data-userid='" + a.data("userid") + "' href='javascript:;'>\u53d6\u6d88</a></div>"), a.remove());
        "1" == a.attr("data-followtype") && (a.after("<div class='followed-btn'>\u4e92\u76f8\u5173\u6ce8<span class='mr5 ml5'>|</span><a rel='removefollow' data-followtype='1' data-usernick=" + a.data("usernick") + " data-userid='" + a.data("userid") + "' href='javascript:;'>\u53d6\u6d88</a></div>"), a.remove());
		
		"3" == a.attr("data-followtype") && (a.after("<div class='followed-btn'>\u4e92\u76f8\u5173\u6ce8</div>"), a.remove());
		 
        "4" == a.attr("data-followtype") && (b.isYouFollowed ? a.after("<div class='followed-btn'>\u4e92\u76f8\u5173\u6ce8</div>") : a.after("<div class='followed-btn'>\u5df2\u5173\u6ce8</div>"), a.remove());
        "5" == a.attr("data-followtype") && (b.isYouFollowed ? a.after("<div class='followed-btn'>\u4e92\u76f8\u5173\u6ce8<span class='mr5 ml5'>|</span><a rel='removefollow' data-followtype='5' data-usernick=" + a.data("usernick") + " data-userid='" + a.data("userid") + "' href='javascript:;'>\u53d6\u6d88</a></div>") : a.after("<div class='followed-btn'>\u5df2\u5173\u6ce8<span class='mr5 ml5'>|</span><a rel='removefollow' data-followtype='5' data-usernick=" + a.data("usernick") + " data-userid='" + a.data("userid") + "' href='javascript:;'>\u53d6\u6d88</a></div>"), a.remove());
		
	 }
	 
	 
	  $.guang.removeFollowCallback = function(b, a) {
          "0" == a.attr("data-followtype") && (a.parent().after("<a rel='follow' href='javascript:;' class='follow-btn-big' data-followtype='0' data-usernick=" + a.data("usernick") + " data-userid=" + a.data("userid") + ">\u52a0\u5173\u6ce8</a>"), a.parent().remove());
        "1" == a.attr("data-followtype") && (a.parent().after("<a rel='follow' href='javascript:;' class='follow-btn' data-followtype='1' data-usernick=" + a.data("usernick") + " data-userid=" + a.data("userid") + ">\u52a0\u5173\u6ce8</a>"), a.parent().remove());
        "5" == a.attr("data-followtype") && (a.parent().after("<a rel='follow' href='javascript:;' class='follow-btn' data-followtype='5' data-usernick=" + a.data("usernick") + " data-userid=" + a.data("userid") + ">\u52a0\u5173\u6ce8</a><br>"), a.parent().remove());
        "2" == a.attr("data-followtype") && a.parents(".section").remove()
    };
	
	
	

	function pageselectCallback(page_index, jq){
		var pageType = goodsPage.pageType;
		var pageA = $page.find("a");
		var prevA = $page.find("a.prev");
		var nextA = $page.find("a.next");
		var pageUrl = goodsPage.pageUrl;
		var sort = goodsPage.sort;
		var tagid = goodsPage.tagid;
		var cateId = goodsPage.cateId;
		var kw = goodsPage.kw;
		pageA.each(function(){
			if(sort !="" || tagid !="" || cateId !="" || kw !=""){
				$(this).attr("href",goodsPage.pagePath + pageUrl + "&p=" + $(this).text());
			}else{
				$(this).attr("href",goodsPage.pagePath + pageUrl + "?p=" + $(this).text());
			}
		});
		if(prevA[0]){
			if(sort!="" || tagid!="" || cateId!=""  || kw !=""){
				prevA.attr("href",goodsPage.pagePath + pageUrl + "&p=" + (parseInt(goodsPage.curPageNum) - 1));
			}else{
				prevA.attr("href",goodsPage.pagePath + pageUrl + "?p=" + (parseInt(goodsPage.curPageNum) - 1));
				}
		}
		if(nextA[0]){
			if(sort!="" || tagid!="" || cateId!=""  || kw !=""){
			nextA.attr("href",goodsPage.pagePath + pageUrl + "&p=" + (parseInt(goodsPage.curPageNum) + 1));
			}else{
			nextA.attr("href",goodsPage.pagePath + pageUrl + "?p=" + (parseInt(goodsPage.curPageNum) + 1));
			}
		}
		pageA.live("click",function(){
			window.location.href = $(this).attr("href");
		});
		return false;
	}	
	})(jQuery);
