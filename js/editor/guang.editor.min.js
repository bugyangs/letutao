(function(d){var o=[{key:"333333",val:"\u7070\u8272-80%"},{key:"666666",val:"\u7070\u8272-60%"},{key:"999999",val:"\u7070\u8272-40%"},{key:"cccccc",val:"\u7070\u8272-20%"},{key:"bb0000",val:"\u6df1\u7ea2"},{key:"dd0000",val:"\u7ea2\u8272"},{key:"ee4488",val:"\u7c89\u7ea2"},{key:"ff66dd",val:"\u6de1\u7d2b"},{key:"333399",val:"\u6df1\u84dd"},{key:"0066cc",val:"\u84dd\u8272"},{key:"0099cc",val:"\u5929\u84dd"},{key:"66cccc",val:"\u6de1\u84dd"},{key:"336600",val:"\u6df1\u7eff"},{key:"999900",val:"\u6df1\u9ec4"},{key:"cccc33",val:"\u6de1\u9ec4"},{key:"77cc33",val:"\u6de1\u7eff"},{key:"663300",val:"\u5496\u5561"},{key:"cc6633",val:"\u8910\u8272"},{key:"ff9900",val:"\u6a59\u9ec4"},{key:"ffcc33",val:"\u9ec4\u8272"}],s={_515151:"333333",_102102102:"666666",_153153153:"999999",_204204204:"cccccc",_18700:"bb0000",_22100:"dd0000",_23868136:"ee4488",_255102221:"ff66dd",_5151153:"333399",_0102204:"0066cc",_0153204:"0099cc",_102204204:"66cccc",_511020:"336600",_1531530:"999900",_20420451:"cccc33",_11920451:"77cc33",_102510:"663300",_20410251:"cc6633",_2551530:"ff9900",_25520451:"ffcc33"},j=[{key:"[\u7ec7]",val:"zz2_thumb.gif"},{key:"[\u795e\u9a6c]",val:"horse2_thumb.gif"},{key:"[\u6d6e\u4e91]",val:"fuyun_thumb.gif"},{key:"[\u7ed9\u529b]",val:"geili_thumb.gif"},{key:"[\u56f4\u89c2]",val:"wg_thumb.gif"},{key:"[\u5a01\u6b66]",val:"vw_thumb.gif"},{key:"[\u718a\u732b]",val:"panda_thumb.gif"},{key:"[\u5154\u5b50]",val:"rabbit_thumb.gif"},{key:"[\u5965\u7279\u66fc]",val:"otm_thumb.gif"},{key:"[\u56e7]",val:"j_thumb.gif"},{key:"[\u4e92\u7c89]",val:"hufen_thumb.gif"},{key:"[\u793c\u7269]",val:"liwu_thumb.gif"},{key:"[\u5475\u5475]",val:"smilea_thumb.gif"},{key:"[\u563b\u563b]",val:"tootha_thumb.gif"},{key:"[\u54c8\u54c8]",val:"laugh.gif"},{key:"[\u53ef\u7231]",val:"tza_thumb.gif"},{key:"[\u53ef\u601c]",val:"kl_thumb.gif"},{key:"[\u6316\u9f3b\u5c4e]",val:"kbsa_thumb.gif"},{key:"[\u5403\u60ca]",val:"cj_thumb.gif"},{key:"[\u5bb3\u7f9e]",val:"shamea_thumb.gif"},{key:"[\u6324\u773c]",val:"zy_thumb.gif"},{key:"[\u95ed\u5634]",val:"bz_thumb.gif"},{key:"[\u9119\u89c6]",val:"bs2_thumb.gif"},{key:"[\u7231\u4f60]",val:"lovea_thumb.gif"},{key:"[\u6cea]",val:"sada_thumb.gif"},{key:"[\u5077\u7b11]",val:"heia_thumb.gif"},{key:"[\u4eb2\u4eb2]",val:"qq_thumb.gif"},{key:"[\u751f\u75c5]",val:"sb_thumb.gif"},{key:"[\u592a\u5f00\u5fc3]",val:"mb_thumb.gif"},{key:"[\u61d2\u5f97\u7406\u4f60]",val:"ldln_thumb.gif"},{key:"[\u53f3\u54fc\u54fc]",val:"yhh_thumb.gif"},{key:"[\u5de6\u54fc\u54fc]",val:"zhh_thumb.gif"},{key:"[\u5618]",val:"x_thumb.gif"},{key:"[\u8870]",val:"cry.gif"},{key:"[\u59d4\u5c48]",val:"wq_thumb.gif"},{key:"[\u5410]",val:"t_thumb.gif"},{key:"[\u6253\u54c8\u6b20]",val:"k_thumb.gif"},{key:"[\u62b1\u62b1]",val:"bba_thumb.gif"},{key:"[\u6012]",val:"angrya_thumb.gif"},{key:"[\u7591\u95ee]",val:"yw_thumb.gif"},{key:"[\u998b\u5634]",val:"cza_thumb.gif"},{key:"[\u62dc\u62dc]",val:"88_thumb.gif"},{key:"[\u601d\u8003]",val:"sk_thumb.gif"},{key:"[\u6c57]",val:"sweata_thumb.gif"},{key:"[\u56f0]",val:"sleepya_thumb.gif"},{key:"[\u7761\u89c9]",val:"sleepa_thumb.gif"},{key:"[\u94b1]",val:"money_thumb.gif"},{key:"[\u5931\u671b]",val:"sw_thumb.gif"},{key:"[\u9177]",val:"cool_thumb.gif"},{key:"[\u82b1\u5fc3]",val:"hsa_thumb.gif"},{key:"[\u54fc]",val:"hatea_thumb.gif"},{key:"[\u9f13\u638c]",val:"gza_thumb.gif"},{key:"[\u6655]",val:"dizzya_thumb.gif"},{key:"[\u60b2\u4f24]",val:"bs_thumb.gif"},{key:"[\u6293\u72c2]",val:"crazya_thumb.gif"},{key:"[\u9ed1\u7ebf]",val:"h_thumb.gif"},{key:"[\u9634\u9669]",val:"yx_thumb.gif"},{key:"[\u6012\u9a82]",val:"nm_thumb.gif"},{key:"[\u5fc3]",val:"hearta_thumb.gif"},{key:"[\u4f24\u5fc3]",val:"unheart.gif"},{key:"[\u732a\u5934]",val:"pig.gif"},{key:"[ok]",val:"ok_thumb.gif"},{key:"[\u8036]",val:"ye_thumb.gif"},{key:"[good]",val:"good_thumb.gif"},{key:"[\u4e0d\u8981]",val:"no_thumb.gif"},{key:"[\u8d5e]",val:"z2_thumb.gif"},{key:"[\u6765]",val:"come_thumb.gif"},{key:"[\u5f31]",val:"sad_thumb.gif"},{key:"[\u8721\u70db]",val:"lazu_thumb.gif"},{key:"[\u86cb\u7cd5]",val:"cake.gif"},{key:"[\u949f]",val:"clock_thumb.gif"},{key:"[\u8bdd\u7b52]",val:"m_thumb.gif"}],p=function(a){return new p.fn.init(a)};p.prototype=p.fn={config:{textareaID:"J_ForumPostCon",formId:"J_ForumPostEditForm",toolbarId:"J_GuangEditorToolbar",mediaDate:{},mediaDateTypes:[],videoLoadMaxNum:5,btnFontSize:{cssName:"font-size",visible:!0,exec:function(a){if(!a.FontSizeWrapDom||0===a.FontSizeWrapDom.length){var b=a.config;d("#"+b.toolbarId).append('\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div class="fontSizeWrap">\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<a btntype="btnFontSizeAction" size="1" style="font-size:12px;" href="javascript:;" title="\u5c0f\u53f7" unselectable="on">\u5c0f\u53f7</a>\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<a btntype="btnFontSizeAction" size="2" style="font-size:14px;" href="javascript:;" title="\u6807\u51c6" unselectable="on">\u6807\u51c6</a>\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<a btntype="btnFontSizeAction" size="3" style="font-size:16px;" href="javascript:;" title="\u5927\u53f7" unselectable="on">\u5927\u53f7</a>\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<a btntype="btnFontSizeAction" size="4" style="font-size:18px;" href="javascript:;" title="\u7279\u5927" unselectable="on">\u7279\u5927</a>\t\t\t\t\t\t\t\t\t\t\t\t\t\t</div>');a.FontSizeWrapDom=d("#"+b.toolbarId+" .fontSizeWrap");a.curVisiableDom&&a.curVisiableDom.hide();a.curVisiableDom=a.FontSizeWrapDom}else a.curVisiableDom===a.FontSizeWrapDom?(a.FontSizeWrapDom.hide(),a.curVisiableDom=null):(a.curVisiableDom&&a.curVisiableDom.hide(),a.FontSizeWrapDom.show(),a.curVisiableDom=a.FontSizeWrapDom)},selectionStyleFun:function(a,b,c){b.nodeName.toLowerCase();var e=null,e=d(b).attr("size")||null;if(!e&&c)for(var b=c.length,g=0;g<b&&!(e=c.eq(g).attr("size")||null);g++);a.curFontSize||(a.curFontSize=null);e!=a.curFontSize&&(null==e?(d("#"+a.config.toolbarId+" .font-size a").text("\u6807\u51c6"),a.curFontSize=null):(d("#"+a.config.toolbarId+" .font-size a").text(a.config.btnFontSize.data["f"+e]),a.curFontSize=e))},data:{f1:"\u5c0f\u53f7",f2:"\u6807\u51c6",f3:"\u5927\u53f7",f4:"\u7279\u5927"},html:"<div class='font-btns font-size'>\t<a href='javascript:;' btntype='btnFontSize' title='\u5b57\u53f7' unselectable='on'>\u6807\u51c6</a></div>"},btnFontSizeAction:{exec:function(a,b){var c=b.attr("size");a.execCommand("fontsize",c);d("#"+a.config.toolbarId+" .font-size a").text(b.attr("title"));a.curFontSize=c;a.curVisiableDom.hide();a.curVisiableDom=null}},btnFontBold:{cssName:"font-bold",visible:!0,exec:function(a,b){b.parent().hasClass("font-bold-active")?d("#"+a.config.toolbarId+" .font-bold").removeClass("font-bold-active"):d("#"+a.config.toolbarId+" .font-bold").addClass("font-bold-active");a.execCommand("bold","")},selectionStyleFun:function(a,b,c){var e=b.nodeName.toLowerCase(),g={b:!0,strong:!0},f=/bold/i,h=b.outerHTML.match(/\<[^\>]+\>/)[0],b=!1;if(g[e]||f.test(h))b=!0;if(!b&&c)for(var l=c.length,i=0;i<l;i++)if(h=c[i],e=h.nodeName.toLowerCase(),h=h.outerHTML.match(/\<[^\>]+\>/)[0],g[e]||f.test(h)){b=!0;break}c=d("#"+a.config.toolbarId+" .font-bold").hasClass("font-bold-active");b&&!c&&d("#"+a.config.toolbarId+" .font-bold").addClass("font-bold-active");!b&&c&&d("#"+a.config.toolbarId+" .font-bold").removeClass("font-bold-active")},html:"<div class='font-btns font-bold'>\t<a href='javascript:;' btntype='btnFontBold' title='\u7c97\u4f53' unselectable='on'>\u7c97\u4f53</a></div>"},btnFontColo:{cssName:"font-color",visible:!0,exec:function(a){if(!a.FontColoWrapDom||0==a.FontColoWrapDom.length){for(var b='<div class="fontColoWrap">',c=o.length,e=0;e<c;e++)b+='<a btntype="btnFontColoAction" coloval="#'+o[e].key+'" style="background-color:#'+o[e].key+';" href="javascript:;" title="'+o[e].val+'" unselectable="on">#'+o[e].key+"</a>";d("#"+a.config.toolbarId).append(b+"</div>");a.FontColoWrapDom=d("#"+a.config.toolbarId+" .fontColoWrap");a.curVisiableDom&&a.curVisiableDom.hide();a.curVisiableDom=a.FontColoWrapDom}else a.curVisiableDom==a.FontColoWrapDom?(a.FontColoWrapDom.hide(),a.curVisiableDom=null):(a.curVisiableDom&&a.curVisiableDom.hide(),a.FontColoWrapDom.show(),a.curVisiableDom=a.FontColoWrapDom)},selectionStyleFun:function(a,b,c){b.nodeName.toLowerCase();var e=null,g=/color\:/i,f=/rgb\(\s?(\d{1,3})\,\s?(\d{1,3})\,\s?(\d{1,3})\)/i,h=b.outerHTML.match(/\<[^\>]+\>/)[0],l=d(b).attr("color");if(l)e=l;else if(g.test(h)&&(h=h.match(f)))e=s["_"+h[1]+h[2]+h[3]],e="#"+e;if(!e&&c)for(var b=c.length,i=0;i<b;i++){l=c[i];l.nodeName.toLowerCase();h=l.outerHTML.match(/\<[^\>]+\>/)[0];if(l=d(l).attr("color"))e=l;else if(g.test(h)&&(h=h.match(f)))e=s["_"+h[1]+h[2]+h[3]],e="#"+e;if(e)break}a.curFontColor||(a.curFontColor=null);e!=a.curFontColor&&(null==e?(d("#"+a.config.toolbarId+" .font-colo i").css("background-color","#333333"),a.curFontColor=null):(d("#"+a.config.toolbarId+" .font-colo i").css("background-color",e),a.curFontColor=e))},html:"<div class='font-btns font-colo'>\t<a href='javascript:;' btntype='btnFontColo' title='\u524d\u666f\u8272' unselectable='on'><span btntype='btnFontColo' unselectable='on'><i btntype='btnFontColo' unselectable='on'></i></span></a></div>"},btnFontColoAction:{exec:function(a,b){var c=b.attr("coloval");a.execCommand("forecolor",c);d("#"+a.config.toolbarId+" .font-colo i").css("background-color",b.attr("coloval"));a.curFontColor=c;a.curVisiableDom.hide();a.curVisiableDom=null}},btnFace:{visible:!0,exec:function(a){if(!a.FaceWrapDom||0==a.FaceWrapDom.length){for(var b='\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div class="faceWrap"><div class="faceWrapBorder clearfix">',c=0;c<j.length;c++)b+='<a btntype="btnFaceAction" faceval="'+j[c].val+'" style="background:#fff url('+GUANGER.path+'images/face/'+j[c].val+') 4px 4px no-repeat;" href="javascript:;" title="'+j[c].key+'" unselectable="on">'+j[c].key+"</a>";d("#"+a.config.toolbarId).append(b+"</div></div>");a.FaceWrapDom=d("#"+a.config.toolbarId+" .faceWrap");a.curVisiableDom&&a.curVisiableDom.hide();a.curVisiableDom=a.FaceWrapDom}else a.curVisiableDom==a.FaceWrapDom?(a.FaceWrapDom.hide(),a.curVisiableDom=null):(a.curVisiableDom&&a.curVisiableDom.hide(),a.FaceWrapDom.show(),a.curVisiableDom=a.FaceWrapDom)},html:"<div class='media-btns face'>\t<a href='javascript:;' btntype='btnFace' title='\u8868\u60c5' unselectable='on'>\u8868\u60c5</a></div>"},btnFaceAction:{exec:function(a,b){if(a.isIE678)a.insertHTML("<img unselectable='on' src='"+GUANGER.path+"images/face/"+b.attr("faceval")+"' title='"+b.attr("title")+"' alt='"+b.attr("title")+"'/>");else{var c=a.iframeDocument.createElement("img");c.src=""+GUANGER.path+"images/face/"+b.attr("faceval");c.setAttribute("unselectable","on");c.setAttribute("title",b.attr("title"));c.setAttribute("alt",b.attr("title"));a.insertHTML(c)}a.curVisiableDom.hide();a.curVisiableDom=null}},btnBaobei:{visible:!0,exec:function(a){if(!a.BaobeiWrapDom||0==a.BaobeiWrapDom.length){var b=function(b){d.ajax({url:GUANGER.path+"/editor/getbaobei",type:"post",dataType:"json",data:{id:b},baobeiId:b,success:function(b){switch(b.code){case 100:b.id=this.baobeiId;b.pic=b.baobeiPic;b.name=b.baobeiName;a.insertMedia(b,"baobei");a.btnBaobeiUrl.val("");a.curVisiableDom&&(a.curVisiableDom.hide(),a.curVisiableDom=null);break;case 101:d.guang.tip.conf.tipClass="tipmodal tipmodal-error",d.guang.tip.show(a.btnBaobei,b.msg)}}})};d("#"+a.config.toolbarId).append('<div class="baobeiWrap">\t<div class="content">\t\t<p class="title">\u5c06\u5b9d\u8d1d\u7f51\u5740\u7c98\u8d34\u5230\u4e0b\u9762\u6846\u4e2d\uff1a</p>\t\t<div class="sg-form">\t\t\t<div class="clearfix">\t\t\t<input class="base-input sg-input" id="J_BaobeiUrl" name="url" value="" placeholder="http://" autocomplete="off">\t\t\t<input type="button" class="bbl-btn" id="J_InsertBaobei" value="\u786e\u5b9a">\t\t\t</div>\t\t\t<div class="text-tip"></div>\t\t</div>\t\t<div class="sg-source">\t\t\t<p class="pt5 pb5">\u5df2\u652f\u6301\u7f51\u7ad9\uff08<a href="http://letushuo.com/contact" target="_blank">\u5546\u5bb6\u7533\u8bf7\u52a0\u5165</a>\uff09\uff1a</p>\t\t\t<div class="source-list clearfix">\t\t\t\t<a class="icon-source icon-taobao" href="http://www.taobao.com/" target="_blank">\u6dd8\u5b9d\u7f51</a>\t\t\t\t<a class="icon-source icon-tmall" href="http://www.tmall.com/" target="_blank">\u5929\u732b\u5546\u57ce</a>\t\t\t\t<a class="icon-source icon-paipai" href="http://buy.qq.com/" target="_blank">QQ\u7f51\u8d2d</a>\t\t\t\t<a class="icon-source icon-mbaobao" href="http://www.mbaobao.com/" target="_blank">\u9ea6\u5305\u5305</a>\t\t\t\t<a class="icon-source icon-vancl" href="http://www.vancl.com/" target="_blank">\u51e1\u5ba2\u8bda\u54c1</a>\t\t\t</div>\t\t</div>\t\t<div class="tipbox-up">\t\t\t<em>\u25c6</em>\t\t\t<span>\u25c6</span>\t\t</div>\t</div></div>');a.btnBaobeiUrl=d("#J_BaobeiUrl");a.btnBaobei=d("#"+a.config.toolbarId+" .baobei");a.BaobeiInerstSubmit=d("#J_InsertBaobei");a.BaobeiInerstSubmit.bind("click",function(){var c=d.trim(a.btnBaobeiUrl.val());-1!=c.indexOf("letushuo.com")?(c=c.match(/baobei\/(\d{3,12})/i))&&c[1]?b(c[1]):(d.guang.tip.conf.tipClass="tipmodal tipmodal-error",d.guang.tip.show(a.BaobeiInerstSubmit,"\u7ad9\u5185\u5b9d\u8d1d\u94fe\u63a5\u9519\u8bef")):""==c?d(".text-tip").html('<span class="errc">\u5b9d\u8d1d\u7f51\u5740\u4e0d\u80fd\u4e3a\u7a7a~</span>').show():d.guang.util.validSite(c)?(d(".text-tip").html('<span class="gc6">\u5b9d\u8d1d\u4fe1\u606f\u6293\u53d6\u4e2d\u2026</span>').show(),a.BaobeiInerstSubmit.disableBtn("bbl-btn"),d.post(GUANGER.path+"/ugc/api/findProduct",{url:c},function(c){100==c.code?(d(".text-tip").html(""),d.guang.ugc.goodspub(c.product,c.isUploadRole,b)):105==c.code?(d(".text-tip").html(""),b(c.product.productVoId)):101==c.code||106==c.code?d(".text-tip").html('<span class="errc">\u5b9d\u8d1d\u4fe1\u606f\u6293\u53d6\u5931\u8d25\uff0c\u8bf7\u91cd\u8bd5\u2026</span>').show():107==c.code?d(".text-tip").html('<span class="errc">\u6682\u65f6\u8fd8\u4e0d\u652f\u6301\u8fd9\u4e2a\u5b9d\u8d1d\u2026</span>').show():108==c.code?(d(".text-tip").html(""),b(c.product.productVoId)):110==c.code?d(".text-tip").html('<span class="errc">\u4eb2\uff0c\u8be5\u5546\u54c1\u6240\u5728\u5546\u5bb6\u5df2\u5217\u5165\u9ed1\u540d\u5355\uff0c\u7533\u8bc9\u8bf7\u8054\u7cfbGCTU@letushuo.com</span>').show():444==c.code?(alert("\u4f60\u5df2\u88ab\u7981\u6b62\u767b\u5f55\uff01"),window.location.href="http://letushuo.com/logout"):442==c.code?alert("\u4eb2\uff0c\u8bf7\u4e0d\u8981\u9891\u7e41\u63a8\u8350\u540c\u4e00\u5e97\u94fa\u5546\u54c1"):443==c.code?alert("\u7531\u4e8e\u8fc7\u5ea6\u63a8\u8350\u540c\u5e97\u94fa\u5546\u54c1\uff0c\u8d26\u6237\u5df2\u51bb\u7ed3\uff0c\u5982\u6709\u7591\u95ee\u8bf7\u8054\u7cfb GCTU@letushuo.com"):445==c.code&&alert("\u57ce\u7ba1\u5927\u961f\u6000\u7591\u4f60\u6076\u610f\u53d1\u5e7f\u544a\uff0c\u5c06\u7981\u6b62\u4f60\u53d1\u5e03\u5546\u54c1\u7684\u6743\u5229\uff0c\u7533\u8bc9\u8bf7\u8054\u7cfbGCTU@letushuo.com");a.BaobeiInerstSubmit.enableBtn("bbl-btn")})):d(".text-tip").html('<span class="errc">\u6682\u65f6\u8fd8\u4e0d\u652f\u6301\u8fd9\u4e2a\u7f51\u7ad9\u5462~</span>').show()});a.curVisiableDom&&a.curVisiableDom.hide();a.BaobeiWrapDom=d("#"+a.config.toolbarId+" .baobeiWrap");a.curVisiableDom=a.BaobeiWrapDom}else a.curVisiableDom==a.BaobeiWrapDom?(a.BaobeiWrapDom.hide(),a.curVisiableDom=null):(a.curVisiableDom&&a.curVisiableDom.hide(),a.BaobeiWrapDom.show(),a.curVisiableDom=a.BaobeiWrapDom)},html:""},btnImg:{visible:!0,exec:function(a){if(!a.ImgWrapDom||0==a.ImgWrapDom.length){var b='<div class="imgWrap">\t<form method="post" enctype="multipart/form-data" class="uploadImg clearfix" action="'+GUANGER.path+'index.php?app=group&ac=do&ts=upload_img" target="photo-frame" id="J_LocalImgForm">\t\t<input type="button" value="\u4e0a\u4f20\u672c\u5730\u56fe\u7247" class="bbl-btn upload-cover">\t\t<input type="file" class="upload-btn" id="J_LocalImgFormSubmit" name="filedata">\t\t<span class="fl gc pt5 pl5">\u652f\u6301GIF\u3001JPG\u3001PNG,\u5927\u5c0f\u4e0d\u8d85\u8fc72M</span>\t</form>\t<div class="netImg clearfix">\t\t<p>\u63d2\u5165\u7f51\u7edc\u56fe\u7247\uff1a</p>\t\t<input class="base-input" id="J_InsertNetImgInput" value="" placeholder="http://" autocomplete="off"/>\t\t<input type="button" id="J_InsertNetImgSubmit" class="bbl-btn" value="\u786e\u5b9a">\t</div>\t<div class="tipbox-up">\t\t<em>\u25c6</em>\t\t<span>\u25c6</span>\t</div>\t<iframe style="width:0px;height:0px;padding:0px;" src="" frameborder="0" name="photo-frame"></iframe></div>';d("#"+a.config.toolbarId).append(b);a.ImgUploadSubmitDom=d("#J_LocalImgFormSubmit");a.ImgUploadFormDom=d("#J_LocalImgForm");a.ImgUploadSubmitDom.change(function(){var b=a.ImgUploadSubmitDom.val();/\.(?:jpg|png|gif)$/i.test(b)?a.ImgUploadFormDom.submit():(a.ImgUploadSubmitDom.val(""),d.guang.tip.conf.tipClass="tipmodal tipmodal-error",d.guang.tip.show(a.ImgUploadSubmitDom,"\u53ea\u652f\u6301GIF\u3001JPG\u3001PNG,\u5927\u5c0f\u4e0d\u8d85\u8fc72M"))});a.uploadImgCallback=function(b,e,imageid){if(b){var g={};g.id=imageid;g.pic=e;g.name="\u4e0a\u4f20\u56fe\u7247";a.insertMedia(g,"img");a.ImgUploadSubmitDom.val("")}else a.ImgUploadSubmitDom.val(""),d.guang.tip.conf.tipClass="tipmodal tipmodal-error",d.guang.tip.show(a.ImgUploadSubmitDom,e);a.curVisiableDom.hide();a.curVisiableDom=null};a.insertNetImgInputDom=d("#J_InsertNetImgInput");a.insertNetImgSubmitDom=d("#J_InsertNetImgSubmit");a.insertNetImgSubmitDom.click(function(){var b=d.trim(a.insertNetImgInputDom.val());if(200<b.length)return d.guang.tip.conf.tipClass="tipmodal tipmodal-error",d.guang.tip.show(a.insertNetImgSubmitDom,"\u8bf7\u8f93\u5165\u4e00\u4e2a\u6b63\u786e\u7684\u56fe\u7247\u7f51\u5740"),"image src is too long!";if(/^https?\:\/\//i.test(b)){d.ajax({url:GUANGER.path+"index.php?app=group&ac=do&ts=net_img",type:"post",dataType:"json",data:{url:b},success:function(imageid){var e={};e.id=imageid;e.pic=b;e.name="\u7f51\u7edc\u56fe\u7247";a.insertMedia(e,"img");a.insertNetImgInputDom.val("");a.curVisiableDom.hide();a.curVisiableDom=null}})}else d.guang.tip.conf.tipClass="tipmodal tipmodal-error",d.guang.tip.show(a.insertNetImgSubmitDom,"\u8bf7\u8f93\u5165\u4e00\u4e2a\u6b63\u786e\u7684\u56fe\u7247\u7f51\u5740(\u5e26http://)")});a.curVisiableDom&&a.curVisiableDom.hide();a.ImgWrapDom=d("#"+a.config.toolbarId+" .imgWrap");a.curVisiableDom=a.ImgWrapDom}else a.curVisiableDom==a.ImgWrapDom?(a.ImgWrapDom.hide(),a.curVisiableDom=null):(a.curVisiableDom&&a.curVisiableDom.hide(),a.ImgWrapDom.show(),a.curVisiableDom=a.ImgWrapDom)},html:"<div class='media-btns img'>\t<a href='javascript:;' btntype='btnImg' title='\u56fe\u7247' unselectable='on'>\u56fe\u7247</a></div>"},btnVideo:{visible:!0,exec:function(a){!a.VideoWrapDom||0==a.VideoWrapDom.length?(d("#"+a.config.toolbarId).append('<div class="videoWrap sg-dialog">\t<div class="content">\t\t<p class="title">\u8f93\u5165\u89c6\u9891\u64ad\u653e\u9875\u7f51\u5740\uff1a</p>\t\t<form class="sg-form" name="shareGoods" action="">\t\t\t<div class="clearfix">\t\t\t<input class="base-input sg-input" id="J_InsertVideoInput" name="url" value="" placeholder="http://" autocomplete="off">\t\t\t<input type="button" id="J_InsertVideo" class="bbl-btn" value="\u786e\u5b9a">\t\t\t</div>\t\t</form>\t\t<div class="sg-source">\t\t\t<p>\u5df2\u652f\u6301\u7f51\u7ad9\uff1a</p>\t\t\t<div class="source-list clearfix">\t\t\t<a class="icon-youku" href="http://www.youku.com/" target="_blank">\u4f18\u9177\u7f51</a>\t\t\t<!--<a class="icon-tudou" href="http://www.tudou.com/" target="_blank">\u571f\u8c46\u7f51</a>\t\t\t<a class="icon-sinavideo" href="http://video.sina.com.cn/" target="_blank">\u65b0\u6d6a\u89c6\u9891</a>-->\t\t\t</div>\t\t</div>\t\t<div class="tipbox-up">\t\t\t<em>\u25c6</em>\t\t\t<span>\u25c6</span>\t\t</div>\t</div></div>'),a.insertVideoSubmitDom=d("#J_InsertVideo"),a.VideoInputDom=d("#J_InsertVideoInput"),a.insertVideoSubmitDom.bind("click",function(){var b=d.trim(a.VideoInputDom.val()),c=/^https?\:\/\/v\.youku\.com\//i,e=/^https?\:\/\/[^\/]+sina_\.com\.cn\//i,g=/^https?\:\/\/[^\/]+tudou_\.com\//i;/^https?\:\/\//i.test(b)?c.test(b)||e.test(b)||g.test(b)?(a.VideoInputDom.val(""),d.ajax({url:GUANGER.path+"index.php?app=group&ac=do&ts=getVideo",type:"post",dataType:"json",data:{url:b},success:function(b){switch(b.code){case 100:a.curVisiableDom.hide();a.curVisiableDom=null;b.id=b.Videoid;b.name=b.title;a.insertMedia(b,"video");break;case 101:d.guang.tip.conf.tipClass="tipmodal tipmodal-error",d.guang.tip.show(a.btnBaobei,b.msg),a.curVisiableDom.hide(),a.curVisiableDom=null}}})):(d.guang.tip.conf.tipClass="tipmodal tipmodal-error",d.guang.tip.show(a.insertVideoSubmitDom,"\u4e0d\u652f\u6301\u8be5\u7ad9\u89c6\u9891")):(d.guang.tip.conf.tipClass="tipmodal tipmodal-error",d.guang.tip.show(a.insertVideoSubmitDom,"\u8bf7\u8f93\u5165\u4e00\u4e2a\u6b63\u786e\u7684\u89c6\u9891\u7f51\u9875\u5730\u5740(\u5e26http://)"))}),a.VideoWrapDom=d("#"+a.config.toolbarId+" .videoWrap"),a.curVisiableDom&&a.curVisiableDom.hide(),a.curVisiableDom=a.VideoWrapDom):a.curVisiableDom==a.VideoWrapDom?(a.VideoWrapDom.hide(),a.curVisiableDom=null):(a.curVisiableDom&&a.curVisiableDom.hide(),a.VideoWrapDom.show(),a.curVisiableDom=a.VideoWrapDom)},html:"<div class='media-btns video'>\t<a href='javascript:;' btntype='btnVideo' title='\u89c6\u9891' unselectable='on'>\u89c6\u9891</a></div>"},btnSplit:{visible:!0,html:"<span class='split'></span>"},btnsLoadOrder:"btnFontSize btnFontBold btnFontColo btnSplit btnFace btnBaobei btnImg btnVideo".split(" ")},isIE678:!+"\v1",iframe:null,iframeDocument:null,setConfig:function(a){return d.extend(!0,this.config,a||{})},init:function(a){this.setConfig(a);this.insertEditor();this.setEditor();0!==this.config.mediaDateTypes.length&&this.reflowMedia();this.id=0},insertEditor:function(){var a=this,b="<div class='guang-editor-wrap'><div class='guang-editor'><div class='edit-btns' id='"+a.config.toolbarId+"'>";d.each(a.config.btnsLoadOrder,function(){var c=a.config[this];c.visible&&(b+=c.html,c.cssName&&(a.selectionStyleFuns||(a.selectionStyleFuns={}),a.selectionStyleFuns[c.cssName]=c.selectionStyleFun))});b+="</div>";b+="<div class='iframeWrap'><iframe frameborder='0' id='J_GuangEditorIframe'></iframe></div>";b+="</div></div>";d("#"+a.config.textareaID).after(b).hide();this.iframe=d("#J_GuangEditorIframe")[0];this.iframeDocument=this.iframe.contentDocument||this.iframe.contentWindow.document},setToolbar:function(){var a=this;d("body").bind("click",function(){a.curVisiableDom&&(a.curVisiableDom.hide(),a.curVisiableDom=null)});d("#"+a.config.toolbarId).bind("click",function(b){var b=b||window.event,c=b.srcElement?d(b.srcElement):d(b.target),e=c.attr("btntype");b.stopPropagation?b.stopPropagation():b.cancelBubble=!0;e&&a.config[e].exec(a,c)})},setEditor:function(){var a=this;a.setToolbar();a.iframeDocument.designMode="on";a.iframeDocument.open();a.isIE678?a.iframeDocument.write('<html><head><style type="text/css">html,body{height:100%;width:100%;margin:0;padding:0;border:0;overflow:auto;background:#fff;cursor:text;font-size:14px;word-wrap:break-word;}p{padding:0;margin:0;}*{line-height:160%;}body{font-family:Arial,Helvetica,Sans-Serif;font-size:14px;text-align:left;} p{margin:10px 0;} em{font-style:italic;} img{border:0;max-width:100%;cursor:default;}</style></head></html>'):a.iframeDocument.write('<html><head><style type="text/css">html,body{height:100%;width:100%;margin:0;padding:0;border:0;overflow:auto;background:#fff;cursor:text;font-size:14px;word-wrap:break-word;}p{padding:0;margin:0;}*{line-height:160%;}html{height:1px;overflow:visible;} body{overflow:hidden;font-family:Arial,Helvetica,Sans-Serif;font-size:14px;text-align:left;} p{margin:10px 0;} em{font-style:italic;} img{border:0;max-width:100%;}</style></head></html>');a.iframeDocument.close();var b=d("#"+a.config.textareaID).val();""!=b&&(a.iframeDocument.body.innerHTML=a.contentDecode(b,!0),a.iframe.contentWindow.focus(),d(a.iframe).height(d(a.iframeDocument).height()));d(a.iframeDocument).bind("mouseup click",function(b){b=b||window.event;d.guang.dialog.isLogin();if(b.type=="mouseup"){b=a.getRange();a.selectionTextContainer=a.isIE678?b.text.length!=0?b.parentElement():null:b.endContainer!=b.startContainer?b.commonAncestorContainer.nodeType==3?b.commonAncestorContainer.parentNode:b.commonAncestorContainer:null;if(a.selectionTextContainer)for(var c in a.selectionStyleFuns){var f=d(a.selectionTextContainer).parents("font,b,span,p,div");f.length==0&&(f=null);a.selectionStyleFuns[c](a,a.selectionTextContainer,f)}}else if(a.selectionTextContainer==null){b=b.srcElement?b.srcElement:b.target;if(a.curVisiableDom){a.curVisiableDom.hide();a.curVisiableDom=null}for(c in a.selectionStyleFuns){f=d(b).parents();f.length==0&&(f=null);a.selectionStyleFuns[c](a,b,f)}}});d(a.iframeDocument).bind("keyup",function(){try{for(var b=a.getRange(),c=a.selectionStyleFuns,f=a.selectionStyleFuns.length,h=0;h<f;h++)c[h](a,a.isIE678?b.parentElement():b.endContainer.parentNode)}catch(l){alert(l)}d(a.iframe).height(d(a.iframeDocument).height());a.toolbarBindScrollEvent||d(window).bind("scroll",function(){a.toolbarBindScrollEvent=true;var b=d(document).scrollTop();if(!a.toolbarOffsetTop)a.toolbarOffsetTop=d("#"+a.config.toolbarId).offset().top;if(a.toolbarOffsetTop<=b){if(!d.guang.util.isIE6()&&!a.toolbarPositionFixed){a.toolbarPositionFixed=true;d("#"+a.config.toolbarId).css({position:"fixed",top:"38px",width:d("#"+a.config.toolbarId).width()+"px"})}}else if(a.toolbarPositionFixed){a.toolbarPositionFixed=false;d("#"+a.config.toolbarId).css({position:"relative",top:"0"})}})});if(d.browser.msie){var b=function(a,b,c){a["e"+b+c]=c;a.attachEvent("on"+b,function(){a["e"+b+c]()})},c;b(a.iframe,"beforedeactivate",function(){c=a.iframeDocument.selection.createRange().getBookmark()});b(a.iframe,"activate",function(){if(c){var b=a.iframeDocument.body.createTextRange();b.moveToBookmark(c);b.select();c=null}})}},getRange:function(){var a=this.iframe.contentWindow,b=null,b=null;this.isIE678?(b=a.document.selection,b=b.createRange()):(b=a.getSelection(),b=b.getRangeAt(0));return b},insertHTML:function(a){var b=this.iframe.contentWindow;b.focus();var c=this.getRange(0),d=null;this.isIE678?c.pasteHTML(a):(c.insertNode(a),c.setEndAfter(a),c.setStartAfter(a),d=b.getSelection(),d.removeAllRanges(),d.addRange(c))},execCommand:function(a,b){try{this.iframeDocument.execCommand(a,!1,b),this.iframe.contentWindow.focus()}catch(c){}},insertMedia:function(a,b){this.config.mediaDate[b]||(this.config.mediaDate[b]=[],this.config.mediaDateTypes.push(b));this.config.mediaDate[b].push(a);if(a.id){var c=a.id}else{var c=this.config.mediaDate[b].length}this.reflowMedia(a.id);var d="";"baobei"==b&&(d="[\u5b9d\u8d1d"+c+"]");"img"==b&&(d="[\u56fe\u7247"+c+"]");"video"==b&&(d="[\u89c6\u9891"+c+"]");this.insertMediaTag(d)},deleteMedia:function(a,b){var c="";"baobei"==a&&(c="[\u5b9d\u8d1d"+(b+1)+"]");"img"==a&&(c="[\u56fe\u7247"+(b+1)+"]");"video"==a&&(c="[\u89c6\u9891"+(b+1)+"]");this.config.mediaDate[a][b].id="0";this.deleteMediaTag(c);setTimeout(this.reflowMedia(),300)},reflowMedia:function(id){var a=this,b=this.getMediasHtml(id);if(!a.MediaViewWrapDom||0==a.MediaViewWrapDom.length)d(a.iframe).parents(".guang-editor").after('<div class="guang-editor-mediaViewWrap clearfix"></div>'),a.MediaViewWrapDom=d(".guang-editor-mediaViewWrap"),a.MediaViewWrapDom.bind("click",function(b){var b=b||window.event,b=b.srcElement?b.srcElement:b.target,e=d(b);"a"==b.nodeName.toLowerCase()&&("insert"==e.data("behavior")&&a.insertMediaTag(e.data("tag")),"delete"==e.data("behavior")&&a.deleteMedia(e.data("type"),parseInt(e.data("index"),10)))}),d(".guang-editor-mediaViewWrap .item").live("mouseover",function(){d(this).find(".btn").show()}),d(".guang-editor-mediaViewWrap .item").live("mouseout",function(){d(this).find(".btn").hide()});this.MediaViewWrapDom.html(b);0==b.length?this.MediaViewWrapDom.hide():this.MediaViewWrapDom.show();this.setMediasInput4form()},setMediasInput4form:function(){for(var a="",b=this.config.mediaDateTypes,c=this.config.mediaDateTypes.length,e=this.config.mediaDate,g=0;g<c;g++){for(var f=b[g],h=e[f],l=e[b[g]].length,i="",k=0;k<l;k++)"0"!==h[k].id&&(i+=i.length?","+h[k].id:h[k].id);a+='<input type="hidden" id="J_GuangEidtorInput_'+f+'" name="'+f+'List" value="'+i+'"/>'}0==d("#J_GuangEidtorInput").length&&d("#"+this.config.formId).append('<span id="J_GuangEidtorInput"></span>');d("#J_GuangEidtorInput").html(a)},getMediasHtml:function(id){for(var a="",b=this.config.mediaDateTypes,c=this.config.mediaDateTypes.length,d=this.config.mediaDate,g=0;g<c;g++)for(var f=b[g],h=d[f],l=h.length,i=0;i<l;i++)if("0"!==h[i].id){var k=h[i],n="",j="";"baobei"==f&&(n="\u5b9d\u8d1d"+id);"img"==f&&(n="\u56fe\u7247"+id);"video"==f&&(n="\u89c6\u9891"+id);j='<div class="item">\t<div class="mediaImg">\t\t<img src="'+k.pic+'" alt="'+k.name+'" title="'+k.name+'">\t\t<div class="btn">\t\t\t<a href="javascript:;" data-type="'+f+'" data-behavior="insert" data-tag="['+n+']" data-id="'+id+'">\u63d2\u5165</a>&nbsp;|&nbsp;<a href="javascript:;" data-type="'+f+'" data-behavior="delete" data-id="'+id+'" data-index="'+i+'">\u5220\u9664</a>\t\t</div>\t</div>\t<p>'+n+"</p></div>";a+=j}return a},insertMediaTag:function(a){this.isIE678||(a=this.iframeDocument.createTextNode(a));this.insertHTML(a)},deleteMediaTag:function(a){for(var b=this.iframeDocument.body,c=b.innerHTML;-1!=c.indexOf(a);)c=c.replace(a,"");b.innerHTML=c;this.iframe.contentWindow.focus()},contentDecode:function(a,b){var c,d=c=0,g={};if(this.tagsData)g=this.tagsData;else{g=this.tagsData={};for(c=j.length;d<c;d++)g[j[d].key]='<img src="'+GUANGER.path+'images/face/'+j[d].val+'" unselectable="on" title="'+j[d].key+'" alt="'+j[d].key+'">';c=o.length;for(d=0;d<c;d++){var f=o[d].key;g["[font"+f+"]"]='<font color="#'+f+'">';g["[font1"+f+"]"]='<font size="1" color="#'+f+'">';g["[font2"+f+"]"]='<font size="2" color="#'+f+'">';g["[font3"+f+"]"]='<font size="3" color="#'+f+'">';g["[font4"+f+"]"]='<font size="4" color="#'+f+'">'}g["[font1]"]='<font size="1">';g["[font2]"]='<font size="2">';g["[font3]"]='<font size="3">';g["[font4]"]='<font size="4">';g["[/font]"]="</font>";g["[span]"]="<span>";g["[/span]"]="</span>";g["[b]"]="<b>";g["[/b]"]="</b>";g["[p]"]="<p>";g["[/p]"]="</p>";g["[br]"]="<br/>";g["[s]"]="&nbsp;"}c=a.replace(/\x20?\[[^\[\]]+\]/gi,function(a){var b=a;" "==a.substring(0,1)&&(b=a.substring(1));return g[b]||a});b||(c=this.mediaDecode(c));return c},mediaDecode:function(a){var b=this;b.tag2HtmlData={};var c=/\[\u56fe\u7247(\d+)\]/,d=/\[\u89c6\u9891(\d+)\]/,g=/\[\u5b9d\u8d1d(\d+)\]/,f=/\[\u56fe\u7247\d+\]/g,h=/\[\u89c6\u9891\d+\]/g,l=/\[\u5b9d\u8d1d\d+\]/g;b.mediaImgList&&(a=a.replace(f,function(a){a=a.match(c)[1];b.id++;var d=a+b.id;b.imgviewDoms||(b.imgviewDoms={});b.imgviewDoms[a]||(b.imgviewDoms[a]=[]);b.imgviewDoms[a][b.imgviewDoms[a].length]=d;return'<div class="pt10 pb10" id="J_Img_'+d+'"></div>'}));if(b.mediaVideoList)var i=0,a=a.replace(h,function(a){i++;if(i<=b.config.videoLoadMaxNum){if(b.tag2HtmlData[a])return b.tag2HtmlData[a];var c=a.match(d)[1],c="<div class='pt10 pb10'>"+b.getVideoHtml(b.mediaVideoList[c])+"</div>";return b.tag2HtmlData[a]=c}return""});-1!=a.indexOf("[\u5b9d\u8d1d")&&(a=a.replace(l,function(a){a=a.match(g)[1];b.id++;var c=a+b.id;b.baobeiviewDoms||(b.baobeiviewDoms={});b.baobeiviewDoms[a]||(b.baobeiviewDoms[a]=[]);b.baobeiviewDoms[a][b.baobeiviewDoms[a].length]=c;return"<div class='pt10 pb10'><div id='J_Baobei_"+c+"' class='baobei clearfix'></div></div>"}));return a},imgDecode:function(){var a=this;if(a.imgviewDoms){for(var b in a.imgviewDoms){var c=a.mediaImgList[b];if(d.browser.msie&&7>=parseInt(d.browser.version,10))d("#ie6img").append('<img id="img'+b+'" src="'+c+'"/>');else{var e=new Image;e.id=b;e.url=c;e.onload=function(){for(var b=parseInt(this.width,10),b='<img width="'+(600<b?600:b)+'" src="'+this.url+'"/>',c=a.imgviewDoms[this.id],e=c.length,f=0;f<e;f++)d("#J_Img_"+c[f]).html(b)};e.src=c}}if(d.browser.msie&&7>=parseInt(d.browser.version,10))for(b in a.imgviewDoms)for(var e=d("#img"+b).width(),e=600<e?600:e,c=a.mediaImgList[b],c='<img width="'+e+'" src="'+c+'"/>',e=a.imgviewDoms[b],g=e.length,f=0;f<g;f++)d("#J_Img_"+e[f]).html(c)}},baobeiDecode:function(){var a=this;if(a.baobeiviewDoms)for(var b in a.baobeiviewDoms)d.ajax({url:GUANGER.path+"/editor/fetchBaobei",type:"post",dataType:"json",data:{id:b},boabeiId:b,success:function(b){var e=a.baobeiviewDoms[this.boabeiId],g=e.length;if(b)if(100==b.code){var f=b.baobei.id,h="http://letushuo.com/baobei/"+f,l=b.baobei.name,l=15<d.guang.util.getStrLength(l)?d.guang.util.substring4ChAndEn(l,15)+"...":l,i=b.baobei.pic,k=b.baobei.recommend,k=k?40<k.length?k.substring(0,40)+"...":k:"",n="";if(b.baobei.brandList&&0<b.baobei.brandList.length){for(var n=n+"<p>\u54c1\u724c\uff1a",j=0;j<b.baobei.brandList.length;j++)var q=b.baobei.brandList[j],n=n+('<a target="_blank" href="http://letushuo.com/pinpai/'+q.url+'">'+q.brandName+"</a>");n+="</p>"}q="";if(b.baobei.tags&&0<b.baobei.tags.length)for(j=0;j<b.baobei.tags.length;j++)var m=b.baobei.tags[j].tagKeyword,q=q+('<a target="_blank" href="http://letushuo.com/xihuan/tag/'+m+'">'+m+"</a>");j=b.baobei.summary.worthCount;b='<div class="baobei-pic">\t<a target="_blank" href="'+h+'"><img src="'+i+'" alt="'+l+'" /></a>\t<span>\uffe5'+b.baobei.priceMin/100+"\uff5e"+b.baobei.priceMax/100+'</span></div><div class="baobei-text">\t<h4><a target="_blank" href="'+h+'">'+l+'</a></h4>\t<div class="baobei-info">\t\t<p>'+k+"</p>\t\t"+n+"\t\t<p>\u6807\u7b7e("+b.baobei.tagCount+")\uff1a\t\t"+q+'\t\t</p>\t</div>\t<div class="clearfix mt15">\t\t<a class="ilike-n" data-prourl="'+h+'" data-proimgsrc="'+i+'" data-proname="'+l+'" data-type="0" data-proid="'+f+'" href="javascript:;">\u559c\u6b22</a>\t\t<div class="stat-box fr">\t\t<a target="_blank" href="'+h+'">\u9274\u5b9a('+j+"/"+(j+b.baobei.summary.unworthCount)+')</a>\t\t<span class="mr5 ml5">|</span>\t\t<a target="_blank" href="'+h+'">\u8bc4\u8bba('+b.baobei.commentNum+')</a>\t\t</div>\t</div></div><a target="_blank" href="'+h+'" class="baobei-link"></a>';for(f=0;f<g;f++)d("#J_Baobei_"+e[f]).html(b)}else for(f=0;f<g;f++)d("#J_Baobei_"+e[f]).hide();else for(f=0;f<g;f++)d("#J_Baobei_"+e[f]).hide()}})},contentEncode:function(a){var b=this,a=this.filterMediaTag(a),c=/\<span(?!.*?\<span).*?\<\/span\>/gi,d=/\<font(?!.*?\<font).*?\<\/font\>/gi,g=/\<b(?!.*?\<b).*?\<\/b\>/gi,f=/\<strong(?!.*?\<strong).*?\<\/strong\>/gi,h=/\<div[^\>]*\>/gi,l=/\<\/div\>/gi,i=/\<p[^\>]*\>/gi,k=/\<\/p\>/gi,j=/\<br[^\>]*\>/gi,p=/\<img[^>]+alt\=\"?(\[.{1,4}\])[^>]+\>/gi,q=/\<[^\>]+\>/g,m=function(a,c){var d=a.match(q),e=d[0],f=d[d.length-1],d=a.replace(e,"").replace(f,""),g=f=null,h=c||null;!h&&-1!=e.indexOf("bold")&&(h=!0);-1!=e.indexOf("size")&&(g=e.match(/size[\s\=\"]+(\d{1})/i))&&(g=g[1]);-1!=e.indexOf("color")&&((f=e.match(/\#([0-9a-f]{6})/i))?f=f[1]:(f=e.match(/rgb\(\s?(\d{1,3})\,\s?(\d{1,3})\,\s?(\d{1,3})\)/i))&&(f=s["_"+f[1]+f[2]+f[3]]));if(!b.hasHexColor)for(var e=b.hasHexColor={},i=0;i<o.length;i++)e[o[i].key]=!0;f&&(f=b.hasHexColor[f]?f:null);g&&4<parseInt(g,10)&&(g="4");h?g||f?(e=" [b] [font"+(g||"")+(f||"")+"]",f=" [/b] [/font]"):(e=" [b]",f=" [/b]"):g||f?(e=" [font"+(g||"")+(f||"")+"]",f=" [/font]"):f=e="";return e+d+f},a=a.replace(/\r|\n/g," [span][/span]"),a=a.replace(/\&nbsp\;?/gi," [s]");if(-1!=a.indexOf("<img")||-1!=a.indexOf("<IMG"))a=a.replace(p," $1");if(-1!=a.indexOf("<br")||-1!=a.indexOf("<BR"))a=a.replace(j," [br]");if(-1!=a.indexOf("<div")||-1!=a.indexOf("<DIV"))a=a.replace(h," [p]"),a=a.replace(l," [/p]");if(-1!=a.indexOf("<p")||-1!=a.indexOf("<P"))a=a.replace(i," [p]"),a=a.replace(k," [/p]");for(;-1!=a.indexOf("<b")||-1!=a.indexOf("<B");)a=a.replace(g,function(a){return m(a,!0)});for(;-1!=a.indexOf("<strong")||-1!=a.indexOf("<STRONT");)a=a.replace(f,function(a){return m(a,!0)});for(;-1!=a.indexOf("<span")||-1!=a.indexOf("<SPAN");)a=a.replace(c,function(a){return m(a)});for(;-1!=a.indexOf("<font")||-1!=a.indexOf("<FONT");)a=a.replace(d,function(a){return m(a)});-1!=a.indexOf("<")&&(a=a.replace(q,""));return a},filterMediaTag:function(){var a=this.iframeDocument.body.innerHTML,b={"\u5b9d\u8d1d":"baobei",},c=["\u5b9d\u8d1d"],d=[/\[\u5b9d\u8d1d\d{1,2}\]/gi],g={},f=0,h=this.config.mediaDateTypes;if(h)for(var j=this.config.mediaDateTypes.length,i=this.config.mediaDate,k=0;k<j;k++)for(var n=h[k],o=i[n],q=i[n].length,m=0;m<q;m++)"0"!==o[m].id&&(g[n]?g[n][g[n].length]=m:g[n]=[m]);for(k=0;3>k;k++)if(-1!=a.indexOf("["+c[k])){var p={},r={};if(h=g[b[c[k]]]){j=h.length;for(m=0;m<j;m++)if(i="["+c[k]+(h[m]+1)+"]",p[i]=!0,0===m)0!==h[0]&&(r[i]="["+c[k]+"1]",f=h[0]);else if(1!==h[m]-h[m-1]||0!==f)f+=h[m]-h[m-1]-1,r[i]="["+c[k]+(h[m]-f+1)+"]";a=a.replace(d[k],function(a){return p[a]?r[a]?r[a]:a:""})}else a=a.replace(d[k],"")}return a},getVideoHtml:function(a,b,c){var b=b||480,c=c||400,e='<embed height="'+c+'" width="'+b+'" allowscriptaccess="never" style="visibility: visible;" pluginspage="http://get.adobe.com/cn/flashplayer/" flashvars="playMovie=true&amp;auto=1" allowfullscreen="true" quality="hight" src="'+a+'" type="application/x-shockwave-flash" wmode="transparent"/>';d.browser.msie&&(e='<OBJECT style="VISIBILITY: visible" classid=clsid:D27CDB6E-AE6D-11cf-96B8-444553540000 width='+b+" height="+c+'>\t<PARAM NAME="_cx" VALUE="11641">\t<PARAM NAME="_cy" VALUE="9419">\t<PARAM NAME="FlashVars" VALUE="playMovie=true&amp;auto=1&amp;adss=0">\t<PARAM NAME="Movie" VALUE="'+a+'">\t<PARAM NAME="Src" VALUE="'+a+'">\t<PARAM NAME="WMode" VALUE="Transparent">\t<PARAM NAME="Play" VALUE="0">\t<PARAM NAME="Loop" VALUE="-1">\t<PARAM NAME="Quality" VALUE="High">\t<PARAM NAME="SAlign" VALUE="LT">\t<PARAM NAME="Menu" VALUE="0">\t<PARAM NAME="Base" VALUE="">\t<PARAM NAME="AllowScriptAccess" VALUE="never">\t<PARAM NAME="Scale" VALUE="NoScale">\t<PARAM NAME="DeviceFont" VALUE="0">\t<PARAM NAME="EmbedMovie" VALUE="0">\t<PARAM NAME="BGColor" VALUE="">\t<PARAM NAME="SWRemote" VALUE="">\t<PARAM NAME="MovieData" VALUE="">\t<PARAM NAME="SeamlessTabbing" VALUE="1">\t<PARAM NAME="Profile" VALUE="0">\t<PARAM NAME="ProfileAddress" VALUE="">\t<PARAM NAME="ProfilePort" VALUE="0">\t<PARAM NAME="AllowNetworking" VALUE="all">\t<PARAM NAME="AllowFullScreen" VALUE="true">\t<PARAM NAME="AllowFullScreenInteractive" VALUE="">\t<div class="note_noflash">\t<p>\u4f60\u8fd8\u672a\u5b89\u88c5flash\u64ad\u653e\u5668\uff0c\u6240\u4ee5\u65e0\u6cd5\u64ad\u653e\u3002</p>\t</div>\t<a href="http://www.adobe.com/go/getflashplayer">\t<img alt="\u83b7\u53d6flash\u64ad\u653e\u5668" src="http://www.adobe.com/images/shared/download_buttons/get_flash_player.gif"/>\t</a></OBJECT>');return e},richText2text:function(a){return a?a=a.replace(/\[[^\]]+\]/g,""):""},html2text:function(a){if(a){if(-1!=a.indexOf("<img"))return"hasConent";a=a.replace(/\<[^\>]+\>/g,"");a=a.replace(/\&nbsp\;/g,"");return d.trim(a)}return""},onlyDecodeFace:function(a){var b;if(this.faceTagsData)b=this.faceTagsData;else{b=this.faceTagsData={};for(var c=0;c<j.length;c++)b[j[c].key]='<img src="'+GUANGER.path+'images/face/'+j[c].val+'" unselectable="on" title="'+j[c].key+'" alt="'+j[c].key+'">'}return a=a.replace(/\[[^\[\]]+\]/gi,function(a){return b[a]?b[a]:""})},decodeContent4Sns:function(a){var b;if(this.faceTagsData)b=this.faceTagsData;else{b=this.faceTagsData={};for(var c=0;c<j.length;c++)b[j[c].key]="true"}a=a.replace(/\[[^\[\]]+\]/gi,function(a){return b[a]?a:""});return a=d.guang.util.ellipse(a,140)}};p.fn.init.prototype=p.fn;d.guang.Editor=p})(jQuery);