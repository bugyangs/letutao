(function(a) {
    a.guang.goods = {
        conf: {
            distance: 400,
            timeout: null,
            timeoutLength: 2E3,
            timeoutLengthMax: 32E3,
            page: 1,
            container: ".goods-block",
            colArray: [],
           containerW:980,columns:4,columnWidthInner:210,columnMargin:20,columnPadding:20,columnWidthOuter:250,
            ajaxUrl: GUANGER.path + "index.php?app=xihuan",
            ajaxData: {
                spage: null,
                bpage: null,
                cateId: null,
                tagId: null,
                userId: null
            }
        },
        init: function() {
            var b = a.guang.goods,
            d = a.guang.goods.conf;
            d.columnWidthOuter = d.columnWidthInner + d.columnMargin + d.columnPadding;
            if (0 == d.colArray.length) for (var c = 0; c < d.columns; c++) d.colArray[c] = 0;
            d = a(".goods-wall").find(".goods");
            1 < d.length ? b.flowGoods(d) : b.ajaxLoad();
            a(window).bind("scroll", b.lazyLoad);
            d.live("mouseover mouseout",
            function(b) {
                var c = a(this);
                if (b.type == "mouseover") {
                    c.css({
                        color: "#666",
                        "box-shadow": "0 1px 2px rgba(35,25,25,0.5)",
                        "-moz-box-shadow": "0 1px 2px rgba(35,25,25,0.5)",
                        "-webkit-box-shadow": "0 1px 2px rgba(35,25,25,0.5)"
                    });
                    c.find(".ilike-m")[0] && c.find(".ilike-m").show();
                    c.find(".ilike-del")[0] && c.find(".ilike-del").show();
                    c.find(".ilike-topic")[0] && c.find(".ilike-topic").show()
                } else {
                    c.css({
                        color: "#999",
                        "box-shadow": "0 1px 2px rgba(34,25,25,0.2)",
                        "-moz-box-shadow": "0 1px 2px rgba(34,25,25,0.2)",
                        "-webkit-box-shadow": "0 1px 2px rgba(34,25,25,0.2)"
                    });
                    c.find(".ilike-m")[0] && c.find(".ilike-m").hide();
                    c.find(".ilike-del")[0] && c.find(".ilike-del").hide();
                    c.find(".ilike-topic")[0] && c.find(".ilike-topic").hide()
                }
            })
        },
		 isLoading: !1,
        lazyLoad: function() {
            var b = a.guang.goods,
            d = a.guang.goods.conf,
            c = a(document).height() - a(window).scrollTop() - a(window).height();
            if (!b.isLoading && c < d.distance) b.isLoading = !0,
            b.ajaxLoad()
        },
      setTimeout: function() {
            var b = a.guang.goods,
            d = a.guang.goods.conf;
            d.timeout = setTimeout(function() {
                b.ajaxLoad()
            },
            d.timeoutLength)
        },
        resetTimeout: function() {
            var b = a.guang.goods,
            d = a.guang.goods.conf;
            if (3E3 < d.timeoutLength) d.timeoutLength = 3E3,
            window.clearTimeout(d.timeout),
            b.setTimeout()
        },
		ajaxLoad: function() {
            var b = a.guang.goods,
            d = a.guang.goods.conf;
            a.guang.goods.conf.ajaxData.spage = d.page;
            a(".goods-loading").show();
            a.post(d.ajaxUrl, d.ajaxData,
            function(c) {
                var e = a("<div>" + c + "</div>").find(".goods"),
                f = a("<div>" + c + "</div>").find(".J_HiddenSpage:last").val(),
                c = a("<div>" + c + "</div>").find(".J_HiddenIsEnd:last").val();
                b.flowGoods(e);
                d.page += 1;
                b.isLoading = !1;
                if (6 == d.page || "true" == c || "5" == f) b.fill(),
                a(".goods-loading").remove(),
                a(".page-box").show(),
                a(window).unbind("scroll", b.lazyLoad)
            })
        },
        flowGoods: function(b) {
            var d = a.guang.goods,
            c = a.guang.goods.conf;
            a(".goods-wall").append('<div class="goods-block"></div>');
            b.each(function() {
                var b = a(this)[0],
                d = jQuery.inArray(Math.min.apply(Math, c.colArray), c.colArray),
                g = c.colArray[d];
                b.style.top = g + "px";
                b.style.left = d * c.columnWidthOuter + "px";
                a(c.container + ":last").append(b);
                c.colArray[d] = g + b.offsetHeight + c.columnMargin
            });
            a(".goods-wall")[0].style.height = Math.max.apply(Math, c.colArray) + "px";
            d.showGoods()
        },
        showGoods: function() {
            a(a.guang.goods.conf.container + ":last").animate({
                opacity: "1"
            },
            500)
        },
        fill: function() {
            for (var b = a.guang.goods.conf,
            d = Math.max.apply(Math, b.colArray), c = jQuery.inArray(d, b.colArray), e = 0; e < b.columns; e++) e != c && a(b.container + ":last").append('<div class="goods-fill" style="top:' + b.colArray[e] + "px;left:" + e * b.columnWidthOuter + "px;height:" + (d - b.colArray[e] - b.columnMargin) + 'px"></div>')
        }
    }
})(jQuery); (function(a) {
    function b(b, f) {
        var g = this,
        h = b.find(":input").not(":button, :image, :reset, :submit");
        a.each(d,
        function() {
            var b = this,
            d = b[0],
            e = b[1],
            k = b[2];
            if (h.filter(a(d))) {
                var j = a(d);
                j.data("vali", 0);
                "info" == k ? j.bind(f.infoEvent,
                function() {
                    c.effects(j, e, k)
                }) : j.bind(f.valiEvent,
                function() {
                    b[3].call(g, j, j.val()) ? "error" == k && (j.data("vali", 1), c.effects(j, "OK", "correct")) : (j.data("vali", 0), c.effects(j, e, k))
                })
            }
        });
        a("input[name=email]")[0] && a("input[name=email]").bind("blur",
        function() {
            var b = a(this);
            1 == b.data("vali") && 11 != b.data("vali") && (b.data("vali", 0), c.effects(b, "", "ajax"), a.ajax({
                type: "post",
                url: GUANGER.path + "index.php?app=user&ac=do&ts=inemail",
                dataType: "json",
                data: "email=" + b.val(),
                success: function(a) {
                    0 == a.code ? (b.data("vali", 11), c.effects(b, "OK", "correct")) : 1 == a.code ? (b.data("vali", 0), c.effects(b, "\u6b64Email\u5df2\u88ab\u6ce8\u518c", "error")) : (b.data("vali", 0), c.effects(b, "\u7cfb\u7edf\u51fa\u9519\u4e86\uff0c\u8bf7\u7a0d\u540e\u518d\u8bd5\u2026", "error"))
                }
            }))
        });
        a("input[name=username]")[0] && a("input[name=username]").bind("blur",
        function() {
            var b = a(this);
            1 == b.data("vali") && 11 != b.data("vali") && (b.data("vali", 0), c.effects(b, "", "ajax"), a.ajax({
                type: "post",
                url: GUANGER.path + "index.php?app=user&ac=do&ts=isusername",
                dataType: "json",
                data: "username=" + b.val(),
                success: function(a) {
                    0 == a.code ? (b.data("vali", 11), c.effects(b, "OK", "correct")) : 2 == a.code ? (b.data("vali", 0), c.effects(b, "\u6b64\u6635\u79f0\u5df2\u88ab\u6ce8\u518c", "error")) : (b.data("vali", 0), c.effects(b, "\u7cfb\u7edf\u51fa\u9519\u4e86\uff0c\u8bf7\u7a0d\u540e\u518d\u8bd5\u2026", "error"))
                }
            }))
        });
        a("input.check")[0] && a("input.check").click(function() { ! 1 == a(this)[0].checked ? (a("input[type=submit]")[0].disabled = "disabled", a("input[type=submit]").removeClass("bbl-btn").addClass("disabled")) : (a("input[type=submit]")[0].disabled = "", a("input[type=submit]").removeClass("disabled").addClass("bbl-btn"))
        });
        b.submit(function() {
            var b = !0;
            h.each(function() {
                0 == a(this).data("vali") && (b = !1)
            });
            b || h.trigger("blur");
            a("input.check")[0] && !1 == a("input.check")[0].checked && (b = !1);
            return b
        })
    }
    a.guang.validator = {
        conf: {
            infoEvent: "focus",
            valiEvent: "blur",
            speed: 100
        },
        message: {},
        fn: function(b, c, g, h) {
            a.isFunction(c) && (h = c, c = "");
            d.push([b, c, g, h])
        },
        effects: function(b, c, d) {
            if (!b.next("span")[0]) {
                b.after('<span class="tip"></span>');
                var h = a.guang.util.getPosition(b).rightTop();
                b.next("span").css({
                    left: h.x + 10 + "px",
                    top: h.y + "px"
                })
            }
            switch (d) {
            case "info":
                b.next(".tip").removeClass().addClass("tip").html(c).fadeIn();
                break;
            case "require":
                b.next(".tip").removeClass().addClass("tip error").html(c).fadeIn();
                b.unbind("focus");
                break;
            case "error":
                b.next(".tip").removeClass().addClass("tip error").html(c).fadeIn();
                b.unbind("focus");
                break;
            case "ajax":
                b.next(".tip").removeClass().addClass("tip ajaxvali").html("").fadeIn();
                b.unbind("focus");
                break;
            case "correct":
                b.next(".tip").removeClass().addClass("tip correct").html("").fadeIn(),
                b.unbind("focus")
            }
        }
    };
	
    var d = [],
    c = a.guang.validator;
    c.fn("input[name=email]", "\u8bf7\u8f93\u5165\u4f60\u7684\u5e38\u7528Email", "info");
    c.fn("input[name=email]", "Email\u683c\u5f0f\u4e0d\u6b63\u786e", "error",
    function(b, c) {
        return a.guang.util.isEmail(c)
    });
    c.fn("input[name=email]", "\u8bf7\u586b\u5199Email", "require",
    function(b, c) {
        return a.guang.util.isEmpty(c)
    });
    c.fn("input[name=username]", "4-30\u4e2a\u5b57\u7b26\uff0c\u652f\u6301\u4e2d\u82f1\u6587\u3001\u6570\u5b57\u3001\u201c_\u201d\u548c\u51cf\u53f7", "info");
    c.fn("input[name=username]", "\u4ec5\u652f\u6301\u4e2d\u82f1\u6587\u3001\u6570\u5b57\u3001\u201c_\u201d\u548c\u51cf\u53f7", "error",
    function(b, c) {
        return a.guang.util.isNick(c)
    });
    c.fn("input[name=username]", "\u6700\u957f\u4e0d\u80fd\u8d85\u8fc730\u4e2a\u5b57\u7b26", "require",
    function(b, c) {
        return a.guang.util.nickMax(c)
    });
    c.fn("input[name=username]", "\u8bf7\u8f93\u5165\u81f3\u5c114\u4e2a\u5b57\u7b26", "require",
    function(b, c) {
        return a.guang.util.nickMin(c)
    });
    c.fn("input[name=username]", "\u8bf7\u586b\u5199\u6635\u79f0", "require",
    function(b, c) {
        return a.guang.util.isEmpty(c)
    });
    c.fn("input[name=pwd]", "6-16\u4e2a\u534a\u89d2\u5b57\u7b26\uff0c\u652f\u6301\u5b57\u6bcd\u3001\u6570\u5b57\u3001\u7b26\u53f7\uff0c\u533a\u5206\u5927\u5c0f\u5199", "info");
    c.fn("input[name=pwd]", "\u5bc6\u7801\u4e2d\u4e0d\u80fd\u5305\u542b\u7a7a\u683c", "error",
    function(a, b) {
        return /^\S+$/.test(b)
    });
    c.fn("input[name=pwd]", "\u5bc6\u7801\u592a\u957f\u4e86\uff0c\u6700\u591a16\u4f4d", "require",
    function(a, b) {
        return 16 < b.length ? !1 : !0
    });
    c.fn("input[name=pwd]", "\u5bc6\u7801\u592a\u77ed\u4e86\uff0c\u6700\u5c116\u4f4d", "require",
    function(b, c) {
        return a.guang.util.tooShort(c, 6)
    });
    c.fn("input[name=pwd]", "\u8bf7\u8f93\u5165\u5bc6\u7801", "require",
    function(a, b) {
        return 0 == b.length ? !1 : !0
    });
    c.fn("input[name=repwd]", "\u8bf7\u91cd\u590d\u8f93\u5165\u4e00\u6b21\u5bc6\u7801", "info");
    c.fn("input[name=repwd]", "\u4e24\u6b21\u8f93\u5165\u7684\u5bc6\u7801\u4e0d\u4e00\u81f4\uff0c\u8bf7\u91cd\u65b0\u8f93\u5165", "error",
    function(b, c) {
        return c == a("#pwd").val()
    });
    c.fn("input[name=repwd]", "\u8bf7\u91cd\u590d\u8f93\u5165\u4e00\u6b21\u5bc6\u7801", "require",
    function(b, c) {
        return a.guang.util.isEmpty(c)
    });
    a.fn.validator = function(c) {
        var d = this.data("validator");
        d && (d.destroy(), this.removeData("validator"));
        c = a.extend(!0, {},
        a.guang.validator.conf, c);
        if (this.is("form")) return this.each(function() {
            var g = a(this);
            d = new b(g, c);
            g.data("validator", d)
        });
        d = new b(this.eq(0).closest("form"), c);
        return this.data("validator", d)
    }
})(jQuery); (function(a) {
    a.fn.textSlider = function(b) {
        b = a.extend({
            speed: "normal",
            step: 1,
            timer: 1E3
        },
        b || {});
        return this.each(function() {
            a.fn.textSlider.scllor(a(this), b)
        })
    };
    a.fn.textSlider.scllor = function(b, d) {
        var c = b.find("ul:eq(0)"),
        e = c.children(),
        f = a(e[0]).height(),
        g = 0 - d.step * f;
        7 < e.length && window.setInterval(function() {
            c.animate({
                marginTop: g
            },
            d.speed,
            function() {
                for (i = 0; i < d.step; i++) c.find("li:first").removeClass("fade"),
                c.find("li:first").appendTo(c);
                c.css({
                    marginTop: 0
                });
                c.find("li:first").addClass("fade")
            })
        },
        d.timer)
    }
})(jQuery); (function(a) {
    a.guang.tip = {
        conf: {
            timer: null,
            timerLength: 3E3,
            tipClass: ""
        },
        show: function(b, d) {
            clearTimeout(a.guang.tip.conf.timer);
            var c = a.guang.util.getPosition(b).topMid();
            a(".tipbox")[0] || a("body").append('<div class="tipbox"></div>');
            a(".tipbox").attr("class", "tipbox " + a.guang.tip.conf.tipClass);
            a(".tipbox").html(d);
            var e = a(".tipbox").outerWidth(),
            f = a(".tipbox").outerHeight();
            a(".tipbox").css({
                left: c.x - e / 2 + "px",
                top: c.y - f - 10 + "px"
            }).fadeIn();
            a.guang.tip.conf.timer = setTimeout(function() {
                a(".tipbox").fadeOut()
            },
            a.guang.tip.conf.timerLength)
        }
    }
})(jQuery); (function(a) {
    a.cookie = function(a, d, c) {
        if ("undefined" != typeof d) {
            c = c || {};
            if (null === d) d = "",
            c.expires = -1;
            var e = "";
            if (c.expires && ("number" == typeof c.expires || c.expires.toUTCString))"number" == typeof c.expires ? (e = new Date, e.setTime(e.getTime() + 864E5 * c.expires)) : e = c.expires,
            e = "; expires=" + e.toUTCString();
            var f = c.path ? "; path=" + c.path: "",
            g = c.domain ? "; domain=" + c.domain: "",
            c = c.secure ? "; secure": "";
            document.cookie = [a, "=", encodeURIComponent(d), e, f, g, c].join("")
        } else {
            d = null;
            if (document.cookie && "" != document.cookie) {
                c = document.cookie.split(";");
                for (e = 0; e < c.length; e++) if (f = jQuery.trim(c[e]), f.substring(0, a.length + 1) == a + "=") {
                    d = decodeURIComponent(f.substring(a.length + 1));
                    break
                }
            }
            return d
        }
    }
})(jQuery);