(function(c){c.guang.goods={conf:{distance:400,page:1,container:".goods-block",colArray:[],containerW:980,columns:4,columnWidthInner:210,columnMargin:20,columnPadding:20,columnWidthOuter:250,ajaxUrl:GUANGER.path+"index.php?app=xihuan",loadFlag:!1,ajaxData:{spage:null,bpage:null,cateId:null,tagId:null,userId:null,pubTime:null,sort:null},justFlow:!1,isGrid:!1,isAjaxLoad:"true"},init:function(){var b=c.guang.goods,a=c.guang.goods.conf;a.columnWidthOuter=a.columnWidthInner+a.columnMargin+a.columnPadding;if(0==
a.colArray.length)for(var d=0;d<a.columns;d++)a.colArray[d]=0;d=c(".goods-wall").find(".goods");a.justFlow?(b.flowGoods(d),b.fill()):(a.isGrid?(d=c(".goods-wall-news").find(".goods-news"),c(".goods-wall-news").each(function(){var a=c(this);a.find(".goods-news").css("height",a.outerHeight()-20)}),c(".page-box").show()):0<d.length&&"true"==a.isAjaxLoad?b.flowGoods(d):b.ajaxLoad(),c(window).bind("scroll",b.lazyLoad));d.live("mouseover mouseout",function(a){var b=c(this);if(a.type=="mouseover"){b.css({color:"#666",
"box-shadow":"0 1px 2px rgba(35,25,25,0.5)","-moz-box-shadow":"0 1px 2px rgba(35,25,25,0.5)","-webkit-box-shadow":"0 1px 2px rgba(35,25,25,0.5)"});b.find(".ilike-m")[0]&&b.find(".ilike-m").show();b.find(".ilike-del")[0]&&b.find(".ilike-del").show();b.find(".ilike-topic")[0]&&b.find(".ilike-topic").show()}else{b.css({color:"#999","box-shadow":"0 1px 2px rgba(34,25,25,0.2)","-moz-box-shadow":"0 1px 2px rgba(34,25,25,0.2)","-webkit-box-shadow":"0 1px 2px rgba(34,25,25,0.2)"});b.find(".ilike-m")[0]&&
b.find(".ilike-m").hide();b.find(".ilike-del")[0]&&b.find(".ilike-del").hide();b.find(".ilike-topic")[0]&&b.find(".ilike-topic").hide()}})},isLoading:!1,lazyLoad:function(){var b=c.guang.goods,a=c.guang.goods.conf,d=c(document).height()-c(window).scrollTop()-c(window).height();!b.isLoading&&d<a.distance&&(b.isLoading=!0,b.ajaxLoad())},ajaxLoad:function(){var b=c.guang.goods,a=c.guang.goods.conf;c.guang.goods.conf.ajaxData.spage=a.page;c(".goods-loading").show();if("false"==a.isAjaxLoad){var d=c("#J_GoodsShow"),
e,f=20*(a.page-1),g=20*a.page,f=d.find(".goods").slice(f,g);d.find(".goods").slice(g,goodsPage.sumGoodsNum).each(function(){c(this)[0].style.display="none"});f.each(function(){var b=c(this)[0],d=jQuery.inArray(Math.min.apply(Math,a.colArray),a.colArray),f=a.colArray[d];b.style.top=f+"px";b.style.left=d*a.columnWidthOuter+"px";b.style.display="block";1<a.page&&(e=c(this).find("img:first"),e.attr("src",e.attr("data-src")));a.colArray[d]=f+b.offsetHeight+a.columnMargin}).animate({opacity:"1"},500);c(".goods-wall")[0]&&
(c(".goods-wall")[0].style.height=Math.max.apply(Math,a.colArray)+"px");a.page+=1;b.isLoading=!1;if(6==a.page||20>f.length||20>=d.find(".goods").length)b.fill(),c(".goods-loading").remove(),c(".page-box").show(),c(window).unbind("scroll",b.lazyLoad),(a.loadFlag=!0)&&jQuery.guang.fallGoods.init()}else c.post(a.ajaxUrl,a.ajaxData,function(d){var e=c("<div>"+d+"</div>").find(".goods"),f=c("<div>"+d+"</div>").find(".J_HiddenSpage:last").val(),g=c("<div>"+d+"</div>").find(".J_HiddenIsEnd:last").val(),
d=c("<div>"+d+"</div>").find(".J_HiddenLastPubTime:last").val();c.guang.goods.conf.ajaxData.pubTime=d;b.flowGoods(e);a.page+=1;b.isLoading=!1;if(6==a.page||"true"==g||"5"==f)b.fill(),c(".goods-loading").remove(),c(".page-box").show(),c(window).unbind("scroll",b.lazyLoad)})},flowGoods:function(b){var a=c.guang.goods,d=c.guang.goods.conf;c(".goods-block")[0]||c(".goods-wall").append('<div class="goods-block"></div>');b.each(function(){var a=c(this)[0],b=jQuery.inArray(Math.min.apply(Math,d.colArray),
d.colArray),g=d.colArray[b];a.style.top=g+"px";a.style.left=b*d.columnWidthOuter+"px";c(d.container+":last").append(a);d.colArray[b]=g+a.offsetHeight+d.columnMargin});c(".goods-wall")[0]&&(c(".goods-wall")[0].style.height=Math.max.apply(Math,d.colArray)+"px");a.showGoods()},showGoods:function(){var b=c.guang.goods.conf;2<b.page?c(b.container+":last").animate({opacity:"1"},100):c(b.container+":last").css("opacity","1")},fill:function(){for(var b=c.guang.goods.conf,a=Math.max.apply(Math,b.colArray),
d=jQuery.inArray(a,b.colArray),e=0;e<b.columns;e++)e!=d&&c(b.container+":last").append('<div class="goods-fill" style="top:'+b.colArray[e]+"px;left:"+e*b.columnWidthOuter+"px;height:"+(a-b.colArray[e]-b.columnMargin)+'px"></div>')}}})(jQuery);
(function(c){c.guang.fallGoods={conf:{distance:400,page:1,limitNum:100,container:".goods-new-block",colArray:[],containerW:960,columns:4,columnWidthInner:210,columnMargin:13,columnPadding:20,columnWidthOuter:243},init:function(){var b=c.guang.fallGoods,a=b.conf;a.columnWidthOuter=a.columnWidthInner+a.columnMargin+a.columnPadding;if(0==a.colArray.length)for(var d=0;d<a.columns;d++)a.colArray[d]=0;c(a.container).find(".goods").live("mouseover mouseout",function(a){var b=c(this);"mouseover"==a.type?
(b.css({color:"#666","box-shadow":"0 1px 2px rgba(35,25,25,0.5)","-moz-box-shadow":"0 1px 2px rgba(35,25,25,0.5)","-webkit-box-shadow":"0 1px 2px rgba(35,25,25,0.5)"}),b.find(".ilike-m")[0]&&b.find(".ilike-m").show(),b.find(".ilike-del")[0]&&b.find(".ilike-del").show(),b.find(".ilike-topic")[0]&&b.find(".ilike-topic").show()):(b.css({color:"#999","box-shadow":"0 1px 2px rgba(34,25,25,0.2)","-moz-box-shadow":"0 1px 2px rgba(34,25,25,0.2)","-webkit-box-shadow":"0 1px 2px rgba(34,25,25,0.2)"}),b.find(".ilike-m")[0]&&
b.find(".ilike-m").hide(),b.find(".ilike-del")[0]&&b.find(".ilike-del").hide(),b.find(".ilike-topic")[0]&&b.find(".ilike-topic").hide())});b.load();c(window).bind("scroll",b.lazyLoad)},load:function(){var b=c.guang.fallGoods,a=b.conf,d=c(a.container),e,f=20*(a.page-1),g=20*a.page,f=d.find(".goods").slice(f,g);d.find(".goods").slice(g,a.limitNum).each(function(){c(this)[0].style.display="none"});f.each(function(){var b=c(this)[0],d=jQuery.inArray(Math.min.apply(Math,a.colArray),a.colArray),f=a.colArray[d];
b.style.top=f+"px";b.style.left=d*a.columnWidthOuter+"px";b.style.display="block";1<a.page&&(e=c(this).find("img:first"),e.attr("src",e.attr("data-src")));a.colArray[d]=f+b.offsetHeight+a.columnMargin}).animate({opacity:"1"},100);d.height(Math.max.apply(Math,a.colArray));a.page+=1;if(6==a.page||20>f.length||20>=d.find(".goods").length)b.fill(),c(window).unbind("scroll",b.lazyLoad)},fill:function(){for(var b=c.guang.fallGoods.conf,a=Math.max.apply(Math,b.colArray),d=jQuery.inArray(a,b.colArray),e=
0;e<b.columns;e++)e!=d&&c(b.container).append('<div class="goods-fill" style="top:'+b.colArray[e]+"px;left:"+e*b.columnWidthOuter+"px;height:"+(a-b.colArray[e]-b.columnMargin)+'px"></div>')},lazyLoad:function(){var b=c.guang.fallGoods,a=b.conf,d=c(document).height()-c(window).scrollTop()-c(window).height();!b.isLoading&&d<a.distance&&b.load()}}})(jQuery);
(function(c){c.guang.gridGoods={conf:{container:c(".goods-grid-wall"),uinitContainer:c(".goods-wall-news1"),goods:c(".goods-grid-wall").find(".goods-news"),goodsName:"goods-news",distance:400,page:1,pageLimit:6,loadUnit:3,loadMaxUint:16},init:function(){var b=c.guang.gridGoods,a=b.conf;a.goods.live("mouseover mouseout",function(b){var a=c(this);"mouseover"==b.type?(a.css({color:"#666","box-shadow":"0 1px 2px rgba(35,25,25,0.5)","-moz-box-shadow":"0 1px 2px rgba(35,25,25,0.5)","-webkit-box-shadow":"0 1px 2px rgba(35,25,25,0.5)"}),
a.find(".ilike-m")[0]&&a.find(".ilike-m").show(),a.find(".ilike-del")[0]&&a.find(".ilike-del").show(),a.find(".ilike-topic")[0]&&a.find(".ilike-topic").show()):(a.css({color:"#999","box-shadow":"0 1px 2px rgba(34,25,25,0.2)","-moz-box-shadow":"0 1px 2px rgba(34,25,25,0.2)","-webkit-box-shadow":"0 1px 2px rgba(34,25,25,0.2)"}),a.find(".ilike-m")[0]&&a.find(".ilike-m").hide(),a.find(".ilike-del")[0]&&a.find(".ilike-del").hide(),a.find(".ilike-topic")[0]&&a.find(".ilike-topic").hide())});a.uinitContainer.each(function(){var b=
c(this);b.find("."+a.goodsName).css("height",b.outerHeight()-20)});b.load();c(window).bind("scroll",b.lazyLoad)},load:function(){var b=c.guang.gridGoods,a=b.conf,d=a.page*a.loadUnit,e=a.uinitContainer.slice((a.page-1)*a.loadUnit,d),d=a.uinitContainer.slice(d,a.loadMaxUint);e.each(function(){var b=c(this);b[0].style.display="block";1<a.page&&b.find("img").each(function(){var a=c(this),b=a.attr("data-src");a.attr("src",b)})});d.each(function(){c(this)[0].style.display="none"});a.page+=1;(a.page==a.pageLimit||
e.length<a.loadUnit||a.uinitContainer.length<=a.loadUnit)&&c(window).unbind("scroll",b.lazyLoad)},lazyLoad:function(){var b=c.guang.gridGoods,a=b.conf;c(document).height()-c(window).scrollTop()-c(window).height()<a.distance&&b.load()}}})(jQuery);
